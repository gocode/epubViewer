<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="bower_components/paper-fab/paper-fab.html">

<dom-module id="epub-viewer">

	<style>
		:host {
			display: flex;
			justify-content: center;
			align-items: center;
		}

		#epubviewer {			
	    	height: 600px;
	    	width: 100%;
	    	border-width: 0px;
	    }

	    paper-fab {
			margin: 30px;
			background: #3f51b5;
			color: #fff;
		}
	</style>

	<template>
		<paper-fab on-click="prev" icon="arrow-back"></paper-fab>
		<iframe id="epubviewer"></iframe>
		<paper-fab on-click="next" icon="arrow-forward"></paper-fab>
	</template>

	<script>
		Polymer({
			is: "epub-viewer",

			next: function() {
				var that = this;
				jQuery.ajax({
				    url: '/nextpage',
				    data: {href: that.$.epubviewer.contentWindow.location.pathname},
				    type: 'POST',
				    success: function(data){
				    	history.pushState(null, null, '/epubviewer/' + JSON.parse(data).Href);
				    	that.$.epubviewer.src = 'http://localhost:9090/' + JSON.parse(data).Href;
				    }
				});
			},

			prev: function() {
				var that = this;
				jQuery.ajax({
				    url: '/prevpage',
				    data: {href: that.$.epubviewer.contentWindow.location.pathname},
				    type: 'POST',
				    success: function(data){
				    	history.pushState(null, null, '/epubviewer/' + JSON.parse(data).Href);
				    	that.$.epubviewer.src = 'http://localhost:9090/' + JSON.parse(data).Href;
				    }
				});
			}

		});
	</script>

</dom-module>